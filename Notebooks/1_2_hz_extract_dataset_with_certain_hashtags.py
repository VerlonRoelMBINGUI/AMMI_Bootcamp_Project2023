# -*- coding: utf-8 -*-
"""1.2-hz-Extract_dataset_with_certain_hashtags.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1917e5AZhqHF6Lkz3dMcURJq-dnJzFsKg
"""

import pandas as pd
import numpy as np

from google.colab import drive
drive.mount('/content/drive')

df = pd.read_csv("/content/drive/MyDrive/Opinion Mining of Ukraine-Russia War Tweets Using Deep Learning/data/processed/labeled_sample_600.csv")
df.head()

import pandas as pd
import re

# Function to check if a text contains a hashtag containing "Putin"
def contains_putin_hashtags(text):
    hashtags = re.findall(r'#\w+', text)
    putin_hashtags = [tag for tag in hashtags if 'Putin' in tag]
    return len(putin_hashtags) > 0

# Filter the DataFrame to keep only rows with "Putin" hashtags
putin_hashtags_text = df[df['text'].apply(contains_putin_hashtags)]['text']

# Create a new DataFrame with "Unnamed: 0" and "text" columns
putin_hashtags_df = pd.DataFrame({'Unnamed: 0': putin_hashtags_text.index, 'text': putin_hashtags_text.values})

# Save the extracted text DataFrame to a CSV file
putin_hashtags_df.to_csv('putin_text.csv', index=False)

# Display the extracted text DataFrame
print(putin_hashtags_df)

putin_data=pd.read_csv("/content/putin_text.csv")

putin_data.head(5)

import pandas as pd
import re
#Tweets that contain hashtag "Zelensky"
def contains_Zelensky_hashtags(text):
    hashtags = re.findall(r'#\w+', text)
    Zelensky_hashtags = [tag for tag in hashtags if 'Zelensky' in tag]
    return len(Zelensky_hashtags) > 0

# Filter the DataFrame to keep only rows with "Putin" hashtags
Zelensky_hashtags_text = df[df['text'].apply(contains_Zelensky_hashtags)]['text']

# Create a new DataFrame with "Unnamed: 0" and "text" columns
Zelensky_hashtags_df = pd.DataFrame({'Unnamed: 0': Zelensky_hashtags_text.index, 'text': Zelensky_hashtags_text.values})

# Save the extracted text DataFrame to a CSV file
Zelensky_hashtags_df.to_csv('Zelensky_text.csv', index=False)

# Display the extracted text DataFrame
print(Zelensky_hashtags_df)

Zelensky_data=pd.read_csv("/content/Zelensky_text.csv")

Zelensky_data.head(5)

#Tweets that contain hashtag "ukraine"

def contains_ukraine_hashtags(text):
    hashtags = re.findall(r'#\w+', text)
    ukraine_hashtags = [tag for tag in hashtags if 'ukraine' in tag]
    return len(ukraine_hashtags) > 0

# Filter the DataFrame to keep only rows with "Putin" hashtags
ukraine_hashtags_text = df[df['text'].apply(contains_ukraine_hashtags)]['text']

# Create a new DataFrame with "Unnamed: 0" and "text" columns
ukraine_hashtags_df = pd.DataFrame({'Unnamed: 0': ukraine_hashtags_text.index, 'text': ukraine_hashtags_text.values})

# Save the extracted text DataFrame to a CSV file
ukraine_hashtags_df.to_csv('ukraine_text.csv', index=False)

# Display the extracted text DataFrame
print(ukraine_hashtags_df)

ukraine_data=pd.read_csv("/content/ukraine_text.csv")

ukraine_data.head(5)

def contains_Russia_hashtags(text):
    hashtags = re.findall(r'#\w+', text)
    Russia_hashtags = [tag for tag in hashtags if 'Russia' in tag]
    return len(Russia_hashtags) > 0

# Filter the DataFrame to keep only rows with "Putin" hashtags
Russia_hashtags_text = df[df['text'].apply(contains_Russia_hashtags)]['text']

# Create a new DataFrame with "Unnamed: 0" and "text" columns
Russia_hashtags_df = pd.DataFrame({'Unnamed: 0': Russia_hashtags_text.index, 'text': Russia_hashtags_text.values})

# Save the extracted text DataFrame to a CSV file
Russia_hashtags_df.to_csv('Russia_text.csv', index=False)

# Display the extracted text DataFrame
print(Russia_hashtags_df)

Russia_data=pd.read_csv("/content/ukraine_text.csv")

Russia_data.head(5)